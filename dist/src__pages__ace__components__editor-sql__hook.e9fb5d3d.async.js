"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6216,8075],{98513:function(W,c,e){e.r(c);var f=e(60715),l=e.n(f),M=e(61272),h=e.n(M),v=e(68136),i=e(47602),g=e(27563),m=e(13407);c.default=function(u){var p,_=(0,v.useRef)({}),E=function(){var d=h()(l()().mark(function o(t){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!u.onSelectionChange){a.next=3;break}return a.next=3,u.onSelectionChange(t);case 3:_.current.runWidget&&_.current.runWidget.update();case 4:case"end":return a.stop()}},o)}));return function(t){return d.apply(this,arguments)}}(),n=function(){var d=h()(l()().mark(function o(t){var r,a;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:t.format=function(){var O=t.getValue(),T=[],C=Date.now(),I=O.replace(/\$\{.*?\}/g,function($){return T.push($),"".concat(C," = ").concat(C)}),N=(0,i.WU)(I),P=-1,U=N.replaceAll("".concat(C," = ").concat(C),function(){return P+=1,T[P]});t.session.setValue(U)},(r=u.runWidget)!==null&&r!==void 0&&r.show&&(_.current.runWidget=new g.default(t,(a=u.runWidget)===null||a===void 0?void 0:a.render));case 2:case"end":return s.stop()}},o)}));return function(t){return d.apply(this,arguments)}}(),D=function(){var d=h()(l()().mark(function o(t){var r,a;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!u.onModeChange){s.next=3;break}return s.next=3,u.onModeChange(t);case 3:r=t.session,a=r.$mode.$highlightRules.getRules(),a.start.push({regex:/\$\{.*?\}/,token:"tant-variable",caseInsensitive:!0});try{r.$mode.$tokenizer=null,r.bgTokenizer.setTokenizer(r.$mode.getTokenizer()),r.bgTokenizer.start(0)}catch(O){}case 7:case"end":return s.stop()}},o)}));return function(t){return d.apply(this,arguments)}}(),y=function(o,t,r,a){return u.textRender?u.textRender(o,t,r,a):null};return(0,m.Z)(function(){var d,o,t=_.current.editor;if(t){if((d=u.runWidget)!==null&&d!==void 0&&d.show&&!_.current.runWidget){var r;_.current.runWidget=new g.default(t,(r=u.runWidget)===null||r===void 0?void 0:r.render);return}!((o=u.runWidget)!==null&&o!==void 0&&o.show)&&_.current.runWidget&&_.current.runWidget.dispose()}},[(p=u.runWidget)===null||p===void 0?void 0:p.show]),{handleInit:n,handleSelectionChange:E,handleModeChange:D,handleTextRender:y}}},27563:function(W,c,e){e.r(c),e.d(c,{default:function(){return p}});var f=e(1834),l=e.n(f),M=e(27694),h=e.n(M),v=e(5772),i=e.n(v),g=e(69609),m=e(86850),u=l()(function _(E){var n=this,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return"\u8FD0\u884C"};h()(this,_),i()(this,"_editor",void 0),i()(this,"_render",void 0),i()(this,"_domNode",document.createElement("div")),i()(this,"_root",(0,m.createRoot)(this._domNode)),i()(this,"_timer",null),i()(this,"updateImmediate",function(){var o=n._editor.getSelectionRange(),t=o.start,r=o.end;if(!t||!r||t.column===r.column&&t.row===r.row){n._domNode.style.display="none",n._domNode.style.top="0px";return}var a=n._editor.renderer,R=a.$cursorLayer.getPixelPosition({row:n._editor.getCursorPosition().row,column:0},!0),s=R.top;n._domNode.style.display="block",n._domNode.style.top="".concat(s,"px"),n._domNode.style.right="".concat(a.$size.width-a.gutterWidth,"px");var O=n._render(n._editor.getSelectedText()||"");n._root.render(O)}),i()(this,"update",(0,g.debounce)(this.updateImmediate,200)),i()(this,"hidden",function(){n._domNode.style.display="none",n._domNode.style.top="0px"}),i()(this,"dispose",function(){n._root.unmount(),n._domNode.remove()}),this._editor=E;var y=E.container,d=y;this._domNode.className="tant-editor-run-widget",d==null||d.append(this._domNode),this._domNode.style.display="none",this._domNode.style.top="0px",this._domNode.onmousedown=function(o){return o.stopPropagation()},this._render=D,E.session.addEventListener("changeScrollTop",function(){n.hidden(),n._timer&&(clearTimeout(n._timer),n._timer=null),n._timer=setTimeout(function(){n.updateImmediate()},200)})}),p=u},13407:function(W,c,e){e.d(c,{Z:function(){return h}});var f=e(68136),l=function(v){return function(i,g){var m=(0,f.useRef)(!1);v(function(){return function(){m.current=!1}},[]),v(function(){if(!m.current)m.current=!0;else return i()},g)}},M=null,h=l(f.useEffect)}}]);
